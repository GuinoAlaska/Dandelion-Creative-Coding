<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="sprites/Logo.jpg">
    <meta name="description" content="Dandelion - Creative Coding Editor">
    <title>Dandelion CC</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Load p5.js -->
    <script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
    
    <!-- CodeMirror Core -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>

    <!-- JavaScript mode -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>

    <!-- Addons for folding -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/fold/foldgutter.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/search/searchcursor.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/fold/foldcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/fold/foldgutter.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/fold/brace-fold.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/fold/comment-fold.min.js"></script>

    <!-- JSzip -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <!-- prettier -->
    <script src="https://unpkg.com/prettier@2.8.8/standalone.js"></script>
    <script src="https://unpkg.com/prettier@2.8.8/parser-babel.js"></script>

    <!-- CodemirrorThemes -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/alisowski/codemirror-theme-noctis-lilac@master/codemirror-noctis-lilac.css">

    <!-- Acorn JS Parser -->
    <script src="https://cdn.jsdelivr.net/npm/acorn@8.11.3/dist/acorn.min.js"></script>

    <base href="/Dandelion-Creative-Coding/">
    <!--base href="/"-->

    <script src="configuration/config.js"></script>
</head>
<body>
    <div id="menu-panel">
        <!-- Menu panel content -->
        <nav id="menu-bar">
            <div id="desktop-menu-bar">
                <ul>
                    <li>
                        <a href="index.html">
                            <img src="sprites/Banner.jpg" alt="Dandelion Banner" style="height:40px; vertical-align:middle; margin-right:0px;">
                        </a>
                    </li>
                    <li class="dropdown">
                        <a class="dropbtn">File</a>
                        <div class="dropdown-content">
                            <!--a href="#" id="new-file">New*</a-->
                            <!--a href="#" id="open-file">Open*</a-->
                            <a id="save-file">Save <span style="color: grey;">Ctrl + S</span></a>
                            <a id="export-file">Export</a>
                            <!--a href="#" id="import-file">Import*</a-->
                        </div>
                    </li>
                    <li class="dropdown">
                        <a class="dropbtn">Edit</a>
                        <div class="dropdown-content">
                            <a id="undo">Undo <span style="color: grey;">Ctrl + Z</span></a>
                            <a id="redo">Redo <span style="color: grey;">Ctrl + Y</span></a>
                            <a id="cut">Cut <span style="color: grey;">Ctrl + X</span></a>
                            <a id="copy">Copy <span style="color: grey;">Ctrl + C</span></a>
                            <a id="paste">Paste <span style="color: grey;">Ctrl + V</span></a>
                            <a id="sort">Sort <span style="color: grey;">Ctrl + Shift + F</span></a>
                            <!--a href="#" id="search">Search* <span style="color: grey;">Ctrl + F</span></a-->
                            <!--a href="#" id="replace">Replace* <span style="color: grey;">Ctrl + H</span></a-->
                        </div>
                    </li>
                    <li class="dropdown">
                        <a class="dropbtn">Sketch</a>
                        <div class="dropdown-content">
                            <a id="hotReload">Toggle Hot Reload</a>
                            <a id="run">Run <span style="color: grey;">Ctrl + R</span></a> 
                            <a href="projectVisualization/index.html" id="run" target="_blank" rel="noopener">See in page</a> 
                            <a id="stop">Stop <span style="color: grey;">Ctrl + R</span></a>
                            <a id="pause">Pause <span style="color: grey;">Ctrl + P</span></a>
                            <a id="step">Step <span style="color: grey;">Ctrl + Alt + S</span></a>
                        </div>
                    </li>
                    <li class="dropdown">
                        <a class="dropbtn">View</a>
                        <div class="dropdown-content">
                            <a id="toggle-tabs">Toggle Tabs Panel</a>
                            <a id="toggle-console">Toggle Console Panel</a>
                            <a id="toggle-editorView">Toggle Preview Panel</a>
                            <a id="toggle-sketch">Toggle Sketch Panel</a>
                        </div>
                    </li>
                    <li class="dropdown">
                        <a class="dropbtn">Help</a>
                        <div class="dropdown-content">
                            <a id="keybinds">Keybinds</a>
                            <a id="documentation">Documentation</a>
                            <a href="about/index.html" id="about" target="_blank" rel="noopener">About</a>
                        </div>
                    </li>
                    <li style="flex: 1 1 auto;"></li>
                    <li id="project-status" class="not-selectable" style="font-size: 0.8em; color: gray; margin-left: 24px; margin-right: 24px;">project is saved</li>
                    <li class="dropdown">
                        <a href="index.html" class="dropbtn">Explore</a>
                    </li>
                    <li style="flex: 1 1 auto;"></li>
                </ul>
                <div id="divisor"></div>
                <ul>
                    <li class="dropdown" style="padding-right:10px">
                        <img src="sprites/user-avatar.png" alt="User Avatar" style="width:32px; height:32px; border-radius:50%; margin-left:10px; margin-right:0px;">
                        
                        <a class="dropbtn">Guest</a>
                        <div class="dropdown-content">
                            <a href="maintenance/index.html" id="login">Log in</a>
                            <a href="maintenance/index.html" id="signin">Sign in</a>
                            <a href="configuration/index.html" id="config" target="_blank" rel="noopener">Configuration</a>
                        </div>
                    </li>
                </ul>
            </div>
            <div id="mobile-menu-bar" class="hidden">
                <ul style="display: flex; align-items: center; width: 100%; padding: 0; margin: 0;">
                    <li>
                        <a href="index.html">
                            <img src="sprites/Banner.jpg" alt="Dandelion Banner" style="height:40px; vertical-align:middle;">
                        </a>
                    </li>
                    <li class="dropdown">
                        <button id="mobile-help-btn" aria-label="Help" style="background:none; border:none; margin-left:10px; margin-right:10px;">
                            <img src="sprites/help-icon.png" alt="Help" style="height:24px;">
                        </button>
                    </li>
                    <li class="not-selectable" style="flex:1 1 auto; text-align:center;">
                        <span id="mobile-project-status" style="font-size:0.8em; color:gray;">project is saved</span>
                    </li>
                    <li style="position:relative;">
                        <button id="mobile-burger-btn" aria-label="Menu" style="background:none; border:none; padding:8px;">
                            <span style="display:block; width:24px; height:3px; background:#fff; margin:4px 0; border-radius:2px;"></span>
                            <span style="display:block; width:24px; height:3px; background:#fff; margin:4px 0; border-radius:2px;"></span>
                            <span style="display:block; width:24px; height:3px; background:#fff; margin:4px 0; border-radius:2px;"></span>
                        </button>
                        <div id="mobile-dropdown-menu" style="display:none; position:absolute; right:0; top:40px; background:#222; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.2); min-width:180px; z-index:100;">
                            <ul style="list-style:none; margin:0; padding:0;">
                                <li class="dropdown">
                                    <span class="dropbtn">File</span>
                                    <div class="dropdown-content">
                                        <a id="save-file-mobile">Save</a>
                                        <a href="index.html">Explore</a>
                                    </div>
                                </li>
                                <li class="dropdown">
                                    <span class="dropbtn">Edit</span>
                                    <div class="dropdown-content">
                                        <a id="undo-mobile">Undo</a>
                                        <a id="redo-mobile">Redo</a>
                                        <a id="cut-mobile">Cut</a>
                                        <a id="copy-mobile">Copy</a>
                                        <a id="paste-mobile">Paste</a>
                                        <a id="sort-mobile">Sort</a>
                                    </div>
                                </li>
                                <li class="dropdown">
                                    <span class="dropbtn">Sketch</span>
                                    <div class="dropdown-content">
                                        <a id="run-mobile">Run</a>
                                        <a id="stop-mobile">Stop</a>
                                        <!--a href="#" id="pause-mobile">Pause</a-->
                                        <!--a href="#" id="step-mobile">Step</a-->
                                    </div>
                                </li>
                                <li class="dropdown">
                                    <span class="dropbtn">View</span>
                                    <div class="dropdown-content">
                                        <a id="toggle-tabs-mobile">Toggle Tabs Panel</a>
                                        <a id="toggle-console-mobile">Toggle Console Panel</a>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li class="dropdown" style="padding-right:10px">
                        <img src="sprites/user-avatar.png" alt="User Avatar" style="width:32px; height:32px; border-radius:50%; margin-left:10px;">
                        <div class="dropdown-content">
                            <a href="maintenance/index.html" id="login">Log in</a>
                            <a href="maintenance/index.html" id="signin">Sign in</a>
                            <a href="configuration/index.html" id="configuration" target="_blank" rel="noopener">Configuration</a>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>
    </div>
    <div id="container">
        <div id="left-panel">
            <div id="runner-panel">
                <!-- Runner panel content -->
                <div class="group">
                    <button id="undo-btn" style="background-image: var(--Icons); background-position: -108px -58px;"></button>
                    <button id="redo-btn" style="background-image: var(--Icons); background-position: -158px -58px;"></button>
                </div>
                <!--select id="icon-selector">
                    <option value="icon1" data-icon="sprites/tab-icons.png" data-icon-position="-5px -5px"></option>
                    <option value="icon1" data-icon="sprites/tab-icons.png" data-icon-position="-5px -5px">Icon 1</option>
                    <option value="icon2" data-icon="sprites/tab-icons.png" data-icon-position="-25px -0px">Icon 2</option>
                    <option value="icon3" data-icon="sprites/tab-icons.png" data-icon-position="-45px -0px">Icon 3</option>
                </select-->
                <div id="mobileLefter" class="patch"></div>
                <input type="text" id="script-name" placeholder="Enter file name" value="sketch.js">
                <button id="hotReload-btn" style="background-image: var(--Icons); background-position: -258px -58px;"></button>
                <div class="group">
                    <button id="execute-stop-btn" style="background-image: var(--Icons); background-position: -8px -8px;"></button>
                    <!--button id="record-btn" style="background-image: url('/sprites/icons.png'); background-position: -108px -8px;"></button-->
                    <button id="pause-btn" style="background-image: var(--Icons); background-position: -158px -108px;"></button>
                </div>
                <div class="group">
                    <!--button id="line-btn" style="background-image: url('/sprites/icons.png'); background-position: -8px -58px;"></button-->
                    <button id="step-btn" style="background-image: var(--Icons); background-position: -58px -58px;"></button>
                </div>
            </div>
            <div id="left-workflow-panel">
                <div id="tabs-panel">
                    <ul id="tabs-list">
                        <li class="tab" data-tab-id="0">
                            <span class="tab-name">sketch.js</span>
                        </li>
                    </ul>
                    <button class="add-tab">+</button>
                    <div class="add-tab-content">
                        <button id="add-js">
                            New JS File
                        </button>
                        <button id="add-txt">
                            New TXT File
                        </button>
                        <button id="add-json">
                            New JSON File
                        </button>
                        <button id="add-import">
                            <input type="file" id="fileInput" accept=".js,.txt,.json"><!--,image/*,audio/*,video/*,.glb,.gltf"-->
                            Import File
                        </button>
                    </div>
                </div>
                <div id="resizer-horizontal-left"></div>
                <div id="left-codeAndConsole-panel">
                    <textarea id="code-input"></textarea>
                    <div id="resizer-vertical-left"></div>
                    <div id="console-panel">
                        <div id="console-title">
                            <p>console</p>
                            <button id="clear-btn">clear</button>
                        </div>
                        <div id="console-output"></div>
                        <div id="console-input">
                            <input type="text" id="console-input-txt" placeholder="" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="resizer-horizontal-main"></div>

        <div id="right-panel">
            <div id="output-top">
                <iframe id="sketchFrame" sandbox="allow-scripts" src="FullScreen/index.html" allow="accelerometer; gyroscope;" width="100%" height="100%" frameborder="0"></iframe>
            </div>
            <div id="resizer-vertical-right"></div>
            <div id="output-bottom"></div>
            <!--div id="variable-bank">
                <h3>Variable Bank</h3>
                <ul id="variable-list">
                    
                </ul>
            </div-->
        </div>
    </div>

    <div id="export-overlay" class="hidden">
        <div id="export-panel">
            <h2>Export Options</h2>
    
            <!-- Tab Buttons -->
            <div id="export-tabs">
                <button class="export-tab active" data-tab="html">HTML / CSS / JS</button>
                <!--button class="export-tab" data-tab="video">Video</button-->
            </div>
    
            <!-- HTML/CSS/JS TAB CONTENT -->
            <div class="export-tab-content hidden" id="export-tab-html">
                <label>Name: <input type="text" id="html-export-name" value="mySketch"></label>
                <p><br>This will generate an HTML page with JS and a full-screen responsive canvas.</p>
            </div>
    
            <!-- VIDEO TAB CONTENT -->
            <!--div class="export-tab-content" id="export-tab-video">
                <label>Name: <input type="text" id="export-name" value="new Video"></label>
                <div id="export-panel-sizeConfig">
                    <label>Width: <input type="number" id="export-width" value="800"></label>
                    <label>Height: <input type="number" id="export-height" value="600"></label>
                </div>
                <label>FPS: <input type="number" id="export-fps" value="30"></label>
                <label>Duration (s): <input type="number" id="export-duration" value="5"></label>
                <label>Format: 
                    <select id="export-format">
                        <option value="webm">WebM</option>
                        <option value="gif">GIF</option>
                    </select>
                </label>
                <p><br>This will generate a video out from your code and specifications.</p>
            </div-->
    
            <!-- Buttons (Shared) -->
            <div class="buttons">
                <button id="start-export">Export</button>
                <button id="cancel-export">Cancel</button>
            </div>
        </div>
    </div>

    <div id="keybinds-overlay" class="hidden">
        <div id="keybinds-panel">
            <h2>Keybinds</h2>
            <br>
            <ul>
                <li><strong>Ctrl + S:</strong> Save File</li>
                <li><strong>Ctrl + Z:</strong> Undo</li>
                <li><strong>Ctrl + Y:</strong> Redo</li>
                <li><strong>Ctrl + X:</strong> Cut</li>
                <li><strong>Ctrl + C:</strong> Copy</li>
                <li><strong>Ctrl + V:</strong> Paste</li>
                <li><strong>Ctrl + Shift + F:</strong> Sort</li>
                <!--li><strong>Ctrl + F:</strong> Search</li-->
                <!--li><strong>Ctrl + H:</strong> Replace</li-->
                <li><strong>Ctrl + R:</strong> Run/Stop Sketch</li>
                <li><strong>Ctrl + P:</strong> Pause Sketch</li>
                <li><strong>Ctrl + Alt + S:</strong> Run Step</li>
            </ul>
            <div class="buttons">
                <button id="close-keybinds">Close</button>
            </div>
        </div>
    </div>

    <div id="alert-overlay" class="hidden">
        <div id="alert-panel">
            <h2>⚠️ Security Warning</h2>
            <p>The code you're trying to run contains potentially dangerous instructions that may:</p>
            <ul>
                <li>Modify IDE behavior or interface</li>
                <li>Inject third-party or remote code</li>
                <li>Access sensitive browser APIs (e.g., window, document)</li>
                <li>Download or trigger external scripts</li>
            </ul>
            <p>We are <strong>not responsible</strong> for any consequences if you choose to continue.</p>

            <div class="buttons">
                <button id="alert-cancel">Cancel Execution</button>
                <button id="alert-continue">Run Anyway</button>
            </div>
        </div>
    </div>

    <div id="mobile-help-overlay" class="hidden">
        <div id="mobile-help-panel">
            <h2>help</h2>
            <button id="mobile-help-close-btn">x</button>
            <br>
            <div class="buttons">
                <button id="mobile-docs-btn">Documentation</button>
                <button id="mobile-about-btn">About</button>
                <button id="mobile-keybinds-btn">Keybinds</button>
            </div>
        </div>
    </div>

    <script src="editor/codeReader.js"></script>
    <script src="editor/sketch.js"></script>
    <script src="theme.js"></script>
    <script src="editor/UX.js"></script>
    <script src="editor/export.js"></script>
    <script src="editor/files.js"></script>
    <script src="editor/scanner.js"></script>
    <script src="MobileMenu.js"></script>
</body>
</html>